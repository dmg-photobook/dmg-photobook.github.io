<!DOCTYPE HTML>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>The PhotoBook Task and Dataset - Dataset</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">

							<!-- Logo -->
							<a href="index.html" class="logo">
									<span class="symbol"><img src="images/fb_logo_2.png" alt="" /></span><span class="title">The PhotoBook Task and Dataset</span>
								</a>
								

							<!-- Nav -->
								<nav>
									<ul>
										<li><a href="#menu">Menu</a></li>
									</ul>
								</nav>

						</div>
					</header>

				<!-- Menu -->
				<nav id="menu">
						<h2>Menu</h2>
						<ul>
								<li><a href="index.html">Home</a></li>
								<li><a href="datasets.html">Datasets</a></li>
								<li><a href="code_models.html">Code & Models</a></li>
								<li><a href="papers.html">Bibliography</a></li>
						</ul>
					</nav>
				<!-- Main -->
					<div id="main">
						<div class="inner">
							<h1>The PhotoBook Dataset</h1>	
						<a href="#dialogue_samples">Dialogue Samples</a><br />
						<a href="#architecture">Dataset Architecture</a><br />
						<a href="#processor">Dataset Processor</a><br />
						<a href="#visualisation">Visualisation</a>
						<br />
						<br />

<span class="image main"><img src="images/screenshot_game.png" alt="" /></span>

<h2 id="dialogue_samples">Dialogue Samples</h2>

Through the goal-oriented nature of participants' interactions in the PhotoBook dataset, we do not only collect image descriptions but rather the full, <b>collaborative process of establishing, grounding and refining referring expressions</b> throughout the  subsequent rounds of the PhotoBook task. As a result, we capture a wide range of <b>dialogue acts such as clarification questions, corrections, extensions, (self-)repairs as well as interactions concerning game mechanics</b>. Consider for example the following interactions: <br /><br />

<blockquote>
<b>A</b>: <i>Man with dog on lap looking at his computer?</i> <br />
<b>B</b>: <i>I don't have that, but could it be a TV in yours? Mine has a man sitting with his dog watching TV.</i>  <br />
<b>A</b>: <i>yes, TV - sorry!</i>  <br />
<b>B</b>: <i>Okay.</i> <br />
</blockquote>
<blockquote>
<b>A</b>: <i>Do you have someone on a big motorcycle and their head isn't visible?</i>  <br />
<b>A</b>: <i>There is a blue car in the background</i> <br />
<b>B</b>: <i>No</i> <br />
<b>A</b>: <i>In any of the pictures?</i> <br />
<b>B</b>: <i>No</i> <br />
<b>A</b>: <i>Okay, thank you</i> <br />
</blockquote>
<blockquote>
<b>B</b>: <i>Woman with hot dog</i> <br />
<b>A</b>: <i>Older girl with glasses holding a hot dog?</i> <br />
<b>B</b>: <i>sitting</i> <br />
<b>A</b>: <i>Yeah</i> <br />

</blockquote>
<blockquote>
<b>A</b>: <i>Do you have a picture with a lady in a fancy dress standing by a motorcycle?</i> <br />
<b>B</b>: <i>no</i> <br />
<b>B</b>: <i>wait</i> <br />
<b>B</b>: <i>yes, in black?</i> <br />
<b>A</b>: <i>Yes, it's a black dress with white trim.</i> <br />
</blockquote>
<blockquote>

<b>A</b>: <i>Is there anything else?</i> <br />
<b>B</b>: <i>Do you have the old lady in the white hat/blue pants reading?</i> <br />
<b>A</b>: <i>Yes, I do.</i> <br />
<b>B</b>: <i>Okay, that's all for me</i> <br />
</blockquote>

In most cases, referring expressions agreed upon during the first rounds of a game are further refined and optimised while re-referring to the same target object in later rounds of the game. These <b>refinements often are manifested in an omission of detail while retaining core features of the target object</b>. <br /><br />

<blockquote>
<b>A</b>: <i>Do you have a boy with a teal coloured shirt with yellow holding a bear with a red shirt?</i> <br />
<b>B</b>: <i>Yes</i> <br />
- <br />
<b>B</b>: <i>Boy with teal shirt and bear with red shirt?</i> <br />
<b>A</b>: <i>Yes!</i> <br />
- <br />
<b>A</b>: <i>Teal shirt boy?</i> <br />
<b>B</b>: <i>No</i> <br />
</blockquote>

<b>Collecting all utterances that refer to a specific target image during a given game creates its co-reference chain</b>. Consider the following examples of first and last references from co-reference chains manually extracted from the PhotoBook dataset: <br /><br />

<blockquote>
<b>F</b>: <i>Two girls near TV playing wii. One in white shirt, one in grey</i><br />
<b>L</b>: <i>Girls in white and grey</i><br />
</blockquote>

<blockquote>
<b>F</b>: <i>A person that looks like a monk sitting on a bench. He's wearing a blue and white ball cap</i><br />
<b>L</b>: <i>The monk </i><br />
</blockquote>

<blockquote>
<b>F</b>: <i>A white, yellow, and blue bus being towed by a blue tow truck</i><br />
<b>L</b>: <i>Yellow/white bus being towed by blue</i><br />
</blockquote>

A sample of full game of five rounds of participant interactions can be seen <a href="transcript_example.html" target="_blank">here</a>.<br /><br />

<h2 id="architecture">Dataset Architecture</h2>

<!--<b>The PhotoBook Dataset can be downloaded <a href="downloads.html">here</a></b>.<br /><br />-->

The PhotoBook Dataset contains 2502 complete dialogues collected through the PhotoBook Conversation task. The dataset is anonymized but allows for tracking specific users over multiple games through a unique agent ID.

<b>The raw PhotoBook Dataset is a collection of JSON files with three levels of data</b>, pertaining either to the <i>Game</i>, one of the five <i>Game Rounds</i> or one of the variable number of <i>Messages</i> in a game round. The data is structured as follows: <br /><br />

<h2 id="architecture">Dataset Architecture</h2>

<!--<b>The PhotoBook Dataset can be downloaded <a href="downloads.html">here</a></b>.<br /><br /> -->

The PhotoBook Dataset contains 2502 complete dialogues collected through the PhotoBook Conversation task. The dataset is anonymized but allows for tracking specific users over multiple games through a unique agent ID. 

<b>The raw PhotoBook Dataset is a collection of JSON files with three levels of data</b>, pertaining either to the <i>Game</i>, one of the five <i>Game Rounds</i> or one of the variable number of <i>Messages</i> in a game round. The data is structured as follows: <br /><br />

<h3>Top level: Game Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>"game_id"</td>
				<td>Unique game ID increasing relative to the game's initial timestamp. Integer ranging from 0 to 2501</td>
	
			</tr>
			<tr>
				<td>"domain_id"</td>
				<td>Indicates the image domain of the game. Integer ranging from 0 to 60. See details about the image domains <a href="">here</a> </td>
			
			</tr>
			<tr>
				<td>"agent_ids"</td>
				<td>Ordered list of the unique agent IDs of the participants in this game; length = 2 </td>
			
			</tr>
			<tr>
				<td>"agent_labels"</td>
				<td>Ordered list of the agents’ speaker labels A or B; length = 2 </td>
				
			</tr>
			<tr>
				<td>"start_time"</td>
				<td>Timestamp of the conversation start. Format: <code>YYYY-MM-DDTHH:mm:ss.ffffff</code> </td>
			
			</tr>
			<tr>
				<td>"feedback"</td>
				<td>Dictionary with the participant's feedback at the end of the game. Keys are the speaker labels A and B, values are pre-formated Strings. See their format <a href="">here</a>. Values are <code>null</code> if no feedback was given.</td>
			
			</tr>
			<tr>
				<td>"rounds"</td>
				<td>Ordered list of Game Round Data objects; length = 5 </td>
			
			</tr>
		</tbody>
	</table>
</div>

<h3>2nd level: Game Round Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>"round_nr"</td>
				<td>Round number indicator. Integer ranging from 1 to 5</td>
			
			</tr>
			<tr>
				<td>"score"</td>
				<td>Dictionary of the participant's scores in this round. Keys are the speaker labels A and B, values are their integer points ranging from 0 to 3 </td>
			
			</tr>
			<tr>
				<td>"images"</td>
				<td>Dictionary of the images displayed to the participant's in this round. Keys are the speaker labels A and B, values are the image paths relative to the <code>images</code> folder. </td>
				
			</tr>
			<tr>
				<td>"common"</td>
				<td>Variable length list of the common images in this game round. Image paths are relative to the <code>images</code> folder.  </td>
			
			</tr>
			<tr>
				<td>"highlighted"</td>
				<td>Dictionary indicating whether the images displayed to the participant's were highlighted or not in this round. Keys are the speaker labels A and B, values are booleans indicating wheter the corresponding image was highlighted. </td>
			
			</tr>
			<tr>
				<td>"messages"</td>
				<td>Ordered list of Message Data objects; variable length</td>
			
			</tr>
		</tbody>
	</table>
</div>

<h3>3rd level: Message Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tbody>
			<tr>
				<td>"timestamp" </td>
				<td>Message timestamp relative to the conversation start; HH:MM:SS[.ssssss] format</td>
	
			</tr>
			<tr>
				<td>"turn"</td>
				<td>Turn indicator with respect to the current game round. A turn contains all subsequent utterances of an agent until the next utterance of the other agent</td>
			
			</tr>
			<tr>
				<td>"speaker"</td>
				<td>Speaker label A or B of the current speaker </td>
			
			</tr>
			<tr>
				<td>"agent_id"</td>
				<td>Agent ID of the current speaker</td>
				
			</tr>
			<tr>
				<td>"message"</td>
				<td>Sent message. String. Game mechanic messages are indicated by an inital keyword in tag brackets. <a href="">See here</a> for a full list of tags.</td>
			
			</tr>
		</tbody>
		</tbody>
	</table>
</div>


A <b>sample logfile</b> can be seen <a href="json_example.html" target="_blank">here</a>. <br /><br />

<h2 id="processor">Dataset Processor</h2>

To simplify processing, we provide a Python dataset processor that reads in the raw logfiles and creates <code>Log</code> objects that contain the raw logfile data plus some additional fields.

The processor can be included into a Python project by adding <code>from processor import Log</code>and accessed through the examplary code in the following snippet.<br /><br />

<pre><code>def load_logs(log_repository, data_path):

    filepath = os.path.join(data_path, log_repository)
    print("Loading logs from {}...".format(filepath))

    missing_counter = 0
    file_count = 0
    for _, _, files in os.walk(filepath):
        file_count += len(files)
    print("{} files found.".format(file_count))
    logs = []
    for root, dirs, files in os.walk(filepath):
        for file in files:
            if file.endswith(".json"):
                with open(os.path.join(root, file), 'r') as logfile:
                    log = Log(json.load(logfile))
                    if log.complete:
                        logs.append(log)

    print("DONE. Loaded {} completed game logs.".format(len(logs)))
    return logs
</code></pre>
Then specify the relative path to the log folder and call the <code>load_logs</code> function:<br /><br />
<pre><code>data_path = ""
logs = load_logs("logs", data_path)
</code></pre>

The processor creates a list of <code>Log</code> objects that hold the same three-tier structure of game, round and message data as described above, but hold some additional information and provide access through dot functions like <code>log.game_id</code>. The information contained in a Log object is as follows:<br /><br />

<h3>Top level: Game Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>"game_id"</td>
				<td>Unique game ID increasing relative to the game's initial timestamp. Integer ranging from 0 to 2501</td>
	
			</tr>
			<tr>
				<td>"domain_id"</td>
				<td>Indicates the image domain of the game. Integer ranging from 0 to 60. See details about the image domains <a href="">here</a> </td>
			
			</tr>
			<tr>
				<td>"domains"
					
				</td>
				<td>
					List of the object types of the two main objects in the game's image set (i.e. its domain). List of Strings, length = 2
				</td>
			</tr>
			<tr>
				<td>"agent_ids"</td>
				<td>Ordered list of the unique agent IDs of the participants in this game; length = 2 </td>
			
			</tr>
			<tr>
				<td>"agent_labels"</td>
				<td>Ordered list of the agents’ speaker labels A or B; length = 2 </td>
				
			</tr>
			<tr>
				<td>"start_time"</td>
				<td>Timestamp of the conversation start. Format: <code>YYYY-MM-DDTHH:mm:ss.ffffff</code> </td>
			
			</tr>
			<tr>
				<td>"duration"
					
				</td>
				<td>
					Total duration of the game. Format: <code>[H]H:MM:SS.ffffff</code>
				</td>
			</tr>
			<tr>
				<td>"total_score"</td>
				<td>The participants total score obtained in the game. Integer ranging from 0 to 30
					
				</td>
			</tr>
			<tr>
				<td>
					"scores"
				</td>
				<td>
					Dictionary of participants' total game scores. Keys are the speaker labels A and B, values are their integer points ranging from 0 to 15
				</td>
			</tr>
			<tr>
				<td>"feedback"</td>
				<td>Dictionary with the participant's feedback at the end of the game. Keys are the speaker labels A and B, values are pre-formated Strings. See their format <a href="">here</a>. Values are <code>null</code> if no feedback was given.</td>
			</tr>
			
			<tr>
				<td>"rounds"</td>
				<td>Ordered list of GameRound objects; length = 5 </td>
			
			</tr>
		</tbody>
	</table>
</div>

<h3>2nd level: Game Round Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>"round_nr"</td>
				<td>Round number indicator. Integer ranging from 1 to 5</td>
			
			</tr>
			<tr>
				<td>"duration"
					
				</td>
				<td>
					Total duration of the game round. Format: <code>[H]H:MM:SS.ffffff</code>
				</td>
			</tr>
			<tr>
				<td>"total_score"</td>
				<td>The participants total score obtained in the game round. Integer ranging from 0 to 6
					
				</td>
			</tr>
			<tr>
				<td>"scores"</td>
				<td>Dictionary of the participant's scores in this round. Keys are the speaker labels A and B, values are their integer points ranging from 0 to 3 </td>
			
			</tr>
			<tr>
				<td>"num_messages</td>
				<td>Total number of messages sent in this game round. Integer</td>
			</tr>
			<tr>
				<td>"images"</td>
				<td>Dictionary of the images displayed to the participant's in this round. Keys are the speaker labels A and B, values are the image paths relative to the <code>images</code> folder. </td>
				
			</tr>
			<tr>
				<td>"common"</td>
				<td>Variable length list of the common images in this game round. Image paths are relative to the <code>images</code> folder.  </td>
			
			</tr>
			<tr>
				<td>"highlighted"</td>
				<td>Dictionary indicating whether the images displayed to the participant's were highlighted or not in this round. Keys are the speaker labels A and B, values are booleans indicating wheter the corresponding image was highlighted. </td>
			
			</tr>
			<tr>
				<td>"messages"</td>
				<td>Ordered list of Message objects; variable length</td>
			
			</tr>
		</tbody>
	</table>
</div>

<h3>3rd level: Message Data</h3>

<div class="table-wrapper">
	<table class="alt">
		<thead>
			<tr>
				<th>Key</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody>
			<tbody>
				<tr>
					<td>"message_id"</td>
					<td>Message index, starting with the first message in the game. Integer </td>

				</tr>
			<tr>
				<td>"timestamp" </td>
				<td>Message timestamp relative to the conversation start; HH:MM:SS[.ssssss] format</td>
	
			</tr>
			<tr>
				<td>"turn"</td>
				<td>Turn indicator with respect to the current game round. A turn contains all subsequent utterances of an agent until the next utterance of the other agent</td>
			
			</tr>
			<tr>
				<td>"speaker"</td>
				<td>Speaker label A or B of the current speaker </td>
			
			</tr>
			<tr>
				<td>"agent_id"</td>
				<td>Agent ID of the current speaker</td>
				
			</tr>
			<tr>
				<td>"message"</td>
				<td>Sent message. String. Game mechanic messages are indicated by an inital keyword in tag brackets. See <a href="data_collection.html">here</a> for a full list of tags.</td>
			
			</tr>
		</tbody>
		</tbody>
	</table>
</div>

<h2 id="visualisation">Visualisation</h2>

The following snippet will print a game transcript as shown <a href="transcript_example.html" target="_blank">here</a>: <br /><br />

<pre><code>def print_transcript(log):
    print("Game ID: {}".format(log.game_id))
    print("Domain ID: {}".format(log.domain_id))
    print("Image set main objects: '{}' and '{}'".format(log.domains[0], log.domains[1]))
    print("Participant IDs: {} and {}".format(log.agent_ids[0], log.agent_ids[1]))
    print("Start Time: {}".format(log.start_time))
    print("Duration: {}".format(log.duration))
    print("Total Score: {}".format(log.total_score))
    print("Player scores: A - {}, B - {}".format(log.scores["A"], log.scores["B"]))
    print("Transcript:\n")

    for round_data in log.rounds:
        print("Round {}".format(round_data.round_nr))
        for message in round_data.messages:
            if message.type == "text":
                print("[{}] {}: {}".format(Log.format_time(message.timestamp), message.speaker, message.text))

            if message.type == "selection":
                label = "common" if message.text.split()[1] == "<com>" else "different"
                print("[{}] {} marks image {} as {}".format(Log.format_time(message.timestamp), message.speaker, Log.strip_image_id(message.text.split()[2]), label))

        print("\nDuration: {}".format(round_data.duration))
        print("Total Score: {}".format(round_data.total_score))        
        print("Player scores: A - {}, B - {}".format(round_data.scores["A"], round_data.scores["B"]))
        print("Number of messages: {}\n".format(round_data.num_messages))

</code></pre>

A similar tool to create HTML visualisations of the games including the displayed sets of images will be made available soon.

						</div>
					</div>

				<!-- Footer -->
					<footer id="footer">
						<div class="inner">
							<section>
								<h2>Contact</h2>
								<ul class="icons">
									<li> For questions and remarks about this website or the PhotoBook Task and Dataset, please contact <a href="mailto:j.haber@qmul.ac.uk"> Janosch Haber</li>
									<li> <a href="https://github.com/dmg-photobook/photobook_dataset.git" class="icon style2 fa-github"><span class="label">GitHub</span></a></li>	
								</ul>
								Raquel Fernández<br />
     							Science Park 107, office F1.07 <br />
     							+31 (0)20 525 7009  <br />
							</section>
							<section>
								

							</section>
							<ul class="copyright">
								<li>&copy; Dialogue Modeling Group, University of Amsterdaom. All rights reserved</li><li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
							</ul>
						</div>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
